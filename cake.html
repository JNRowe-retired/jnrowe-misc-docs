


<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Cake usage &mdash; jnrowe-misc documentation</title>
    <link rel="stylesheet" href="_static/cloud.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="#" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '',
        VERSION:     '1.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="_static/toggle_sections.js"></script>
    <link rel="top" title="jnrowe-misc documentation" href="index.html" />
    <link rel="prev" title="Contributing" href="contributing.html" /> 
  </head>
  <body>
    <div class="relbar-top">
        
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="contributing.html" title="Contributing"
             accesskey="P">previous</a> |</li>
    <li><a href="index.html">jnrowe-misc Documentation</a> &raquo; </li>
 
      </ul>
    </div>
    </div>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="cake-usage">
<h1><tt class="docutils literal"><span class="pre">Cake</span></tt> usage<a class="headerlink" href="#cake-usage" title="Permalink to this headline">¶</a></h1>
<p><a class="reference external" href="http://pypi.python.org/pypi/cake">cake</a> is used for many of the repetitive and maintenance-related tasks in
this overlay.  It was chosen over <strong class="command">make</strong> as the <tt class="file docutils literal"><span class="pre">Makefile</span></tt> was
simply becoming too unwieldy, and as many of the support tools were already
written in <a class="reference external" href="http://python.org/">Python</a> <tt class="docutils literal"><span class="pre">cake</span></tt> seemed like a good choice.</p>
<div class="section" id="cupage-support">
<h2><tt class="docutils literal"><span class="pre">cupage</span></tt> support<a class="headerlink" href="#cupage-support" title="Permalink to this headline">¶</a></h2>
<div class="section" id="gen-cupage-conf">
<h3><tt class="docutils literal"><span class="pre">gen_cupage_conf</span></tt><a class="headerlink" href="#gen-cupage-conf" title="Permalink to this headline">¶</a></h3>
<p>This task recreates the <tt class="file docutils literal"><span class="pre">support/cupage.conf</span></tt> file for this repository,
see <a class="reference internal" href="contributing.html#watch-files"><em>watch files</em></a>.</p>
</div>
<div class="section" id="cupage-check">
<h3><tt class="docutils literal"><span class="pre">cupage_check</span></tt><a class="headerlink" href="#cupage-check" title="Permalink to this headline">¶</a></h3>
<p>This task checks a <tt class="file docutils literal"><span class="pre">watch</span></tt> file exists for every package in the
repository, see <a class="reference internal" href="contributing.html#watch-files"><em>watch files</em></a>.</p>
</div>
</div>
<div class="section" id="layman-support">
<h2><tt class="docutils literal"><span class="pre">layman</span></tt> support<a class="headerlink" href="#layman-support" title="Permalink to this headline">¶</a></h2>
<div class="section" id="layman-check">
<h3><tt class="docutils literal"><span class="pre">layman_check</span></tt><a class="headerlink" href="#layman-check" title="Permalink to this headline">¶</a></h3>
<p>This task performs a XML syntax check on the <a class="reference external" href="http://layman.sourceforge.net">layman</a> support files.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">It is simply a check for &#8220;well formed-ness&#8221; as there is apparently no
published schema to verify <tt class="docutils literal"><span class="pre">layman</span></tt> configs against.</p>
</div>
</div>
</div>
<div class="section" id="maintenance-support-tasks">
<h2>Maintenance support tasks<a class="headerlink" href="#maintenance-support-tasks" title="Permalink to this headline">¶</a></h2>
<div class="section" id="gen-stable">
<h3><tt class="docutils literal"><span class="pre">gen_stable</span></tt><a class="headerlink" href="#gen-stable" title="Permalink to this headline">¶</a></h3>
<p>This task creates a <tt class="file docutils literal"><span class="pre">support/stabilisation.org</span></tt> snippet.  It requires a
full <tt class="docutils literal"><span class="pre">&lt;category&gt;/&lt;package&gt;-&lt;version&gt;</span></tt> string as its only argument.  See
the <a class="reference internal" href="contributing.html#stabilisation-org"><em>stabilisation.org</em></a> documentation.</p>
</div>
<div class="section" id="keyword-check">
<h3><tt class="docutils literal"><span class="pre">keyword_check</span></tt><a class="headerlink" href="#keyword-check" title="Permalink to this headline">¶</a></h3>
<p>This task is used to check whether packages have stable, or at least unstable,
keywords available on <tt class="docutils literal"><span class="pre">amd64</span></tt> and <tt class="docutils literal"><span class="pre">x86</span></tt>.  These are the only supported archs
in this repository, and packages should be available on both where possible.</p>
<p>Previously <tt class="docutils literal"><span class="pre">arm</span></tt> was also supported, but this is no longer the case as the
packages that were most useful on <tt class="docutils literal"><span class="pre">arm</span></tt> have moved to another overlay.</p>
</div>
<div class="section" id="open-bug">
<h3><tt class="docutils literal"><span class="pre">open_bug</span></tt><a class="headerlink" href="#open-bug" title="Permalink to this headline">¶</a></h3>
<p>This task will open a bug in the <a class="reference external" href="https://github.com/JNRowe/jnrowe-misc/">GitHub repository&#8217;s</a> issue tracker.  It
requires one argument, which will be used as the bug&#8217;s title.  If you give a
second argument it will be used for the bug&#8217;s body.  A third argument, if given,
will be used for the initial label for the bug.</p>
<p>The examples below should make the usage quite clear:</p>
<div class="highlight-python"><pre>▶ cake open_bug 'new title'
▶ cake open_bug 'title' 'with extended body content'
▶ cake open_bug 'title' 'body' 'initial label'
▶ cake open_bug 'title' '' 'initial label'</pre>
</div>
<p>It reads your GitHub authentication data using <tt class="docutils literal"><span class="pre">git</span> <span class="pre">config</span></tt>, see the <cite>setup
help page on GitHub</cite> for more information.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This task fetches the repository identifier from the <tt class="docutils literal"><span class="pre">remote.origin.url</span></tt>
setting.  See <em class="manpage">git-config(1)</em>.</p>
</div>
</div>
<div class="section" id="bump-pkg">
<h3><tt class="docutils literal"><span class="pre">bump_pkg</span></tt><a class="headerlink" href="#bump-pkg" title="Permalink to this headline">¶</a></h3>
<p>This task is a special case of the <tt class="docutils literal"><span class="pre">open_bug</span></tt> task above whose sole
purpose is to file bump requests with the minimum of fuss.  It requires a full
<tt class="docutils literal"><span class="pre">&lt;category&gt;/&lt;package&gt;-&lt;version&gt;</span></tt> string as its only argument.</p>
<p>It reads your GitHub authentication data using <tt class="docutils literal"><span class="pre">git</span> <span class="pre">config</span></tt>, see the <cite>setup
help page on GitHub</cite> for more information.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This task fetches the repository identifier from the <tt class="docutils literal"><span class="pre">remote.origin.url</span></tt>
setting.  See <em class="manpage">git-config(1)</em>.</p>
</div>
</div>
</div>
<div class="section" id="org-mode-support">
<h2><tt class="docutils literal"><span class="pre">org-mode</span></tt> support<a class="headerlink" href="#org-mode-support" title="Permalink to this headline">¶</a></h2>
<div class="section" id="gen-removals">
<h3><tt class="docutils literal"><span class="pre">gen_removals</span></tt><a class="headerlink" href="#gen-removals" title="Permalink to this headline">¶</a></h3>
<p>This task is used to generate <tt class="file docutils literal"><span class="pre">removals.org</span></tt>, see the <a class="reference internal" href="contributing.html#package-mask"><em>package.mask</em></a>
documentation for more information.</p>
</div>
</div>
<div class="section" id="portage-support">
<h2><tt class="docutils literal"><span class="pre">portage</span></tt> support<a class="headerlink" href="#portage-support" title="Permalink to this headline">¶</a></h2>
<div class="section" id="gen-categories">
<h3><tt class="docutils literal"><span class="pre">gen_categories</span></tt><a class="headerlink" href="#gen-categories" title="Permalink to this headline">¶</a></h3>
<p>This task recreates the overlay&#8217;s categories list in <tt class="file docutils literal"><span class="pre">profiles/categories</span></tt>.</p>
</div>
<div class="section" id="gen-manifests">
<h3><tt class="docutils literal"><span class="pre">gen_manifests</span></tt><a class="headerlink" href="#gen-manifests" title="Permalink to this headline">¶</a></h3>
<p>This task will regenerate any missing, or stale, <tt class="file docutils literal"><span class="pre">Manifest</span></tt> files.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">If you have a <span class="target" id="index-0"></span><tt class="xref std std-envvar docutils literal"><span class="pre">PORTAGE_GPG_KEY</span></tt> setting in <tt class="file docutils literal"><span class="pre">/etc/make.conf</span></tt> it
will use that key to sign the created files.  See <em class="manpage">make.conf(5)</em> for
more information on <tt class="file docutils literal"><span class="pre">Manifest</span></tt> signing.</p>
</div>
</div>
<div class="section" id="gen-news-sigs">
<h3><tt class="docutils literal"><span class="pre">gen_news_sigs</span></tt><a class="headerlink" href="#gen-news-sigs" title="Permalink to this headline">¶</a></h3>
<p>This task is used regenerate any missing, or stale, signatures for news
files.  See the <a class="reference external" href="http://www.gentoo.org/proj/en/glep/glep-0042.html">GLEP 42</a> documentation for more information.</p>
</div>
<div class="section" id="gen-use-local-desc">
<h3><tt class="docutils literal"><span class="pre">gen_use_local_desc</span></tt><a class="headerlink" href="#gen-use-local-desc" title="Permalink to this headline">¶</a></h3>
<p>This task generates the <tt class="file docutils literal"><span class="pre">profiles/user.local.desc</span></tt> file using the <tt class="docutils literal"><span class="pre">USE</span></tt>
flag information in each package&#8217;s <tt class="file docutils literal"><span class="pre">metadata.xml</span></tt> definitions.  See
<em class="manpage">egencache(1)</em> and the <a class="reference external" href="http://devmanual.gentoo.org/ebuild-writing/misc-files/metadata/index.html">devmanual&#8217;s metadata.xml</a> documentation for
more information.</p>
</div>
</div>
<div class="section" id="restructuredtext-support">
<h2>reStructuredText support<a class="headerlink" href="#restructuredtext-support" title="Permalink to this headline">¶</a></h2>
<div class="section" id="gen-html">
<h3><tt class="docutils literal"><span class="pre">gen_html</span></tt><a class="headerlink" href="#gen-html" title="Permalink to this headline">¶</a></h3>
<p>This task generates HTML from all files ending in <tt class="docutils literal"><span class="pre">.rst</span></tt>.  It uses the
equivalent of the <strong class="command">rst2html.py</strong> command&#8217;s <tt class="docutils literal"><span class="pre">--strict</span></tt> flag, and will
fail if any errors or warnings are issued.</p>
</div>
<div class="section" id="gen-sphinx-html">
<h3><tt class="docutils literal"><span class="pre">gen_sphinx_html</span></tt><a class="headerlink" href="#gen-sphinx-html" title="Permalink to this headline">¶</a></h3>
<p>This task rebuilds the documentation contained in <tt class="file docutils literal"><span class="pre">doc/</span></tt> using <a class="reference external" href="http://sphinx.pocoo.org/">Sphinx</a>.</p>
</div>
<div class="section" id="gen-thanks">
<h3><tt class="docutils literal"><span class="pre">gen_thanks</span></tt><a class="headerlink" href="#gen-thanks" title="Permalink to this headline">¶</a></h3>
<p>This task is used to create <tt class="file docutils literal"><span class="pre">doc/thanks.rst</span></tt> from <tt class="file docutils literal"><span class="pre">README.rst</span></tt>, its
purpose is to remove the necessity to manually edit both files when adding
contributor information.</p>
</div>
<div class="section" id="rst-check">
<h3><tt class="docutils literal"><span class="pre">rst_check</span></tt><a class="headerlink" href="#rst-check" title="Permalink to this headline">¶</a></h3>
<p>This task parses all files ending in <tt class="docutils literal"><span class="pre">.rst</span></tt>.  It uses the equivalent of the
<strong class="command">rst2html.py</strong> command&#8217;s <tt class="docutils literal"><span class="pre">--strict</span></tt> flag, and will fail if any errors
or warnings are issued.</p>
</div>
</div>
<div class="section" id="tasks-utils">
<h2><tt class="docutils literal"><span class="pre">tasks.utils</span></tt><a class="headerlink" href="#tasks-utils" title="Permalink to this headline">¶</a></h2>
<p>This module is used to provide support functionality for use in the
<strong class="command">cake</strong> tasks.  The developer facing functions are described below.</p>
<dl class="function">
<dt id="newer">
<tt class="descname">newer</tt><big>(</big><em>file1</em>, <em>file2</em><big>)</big> &rarr; Bool<a class="headerlink" href="#newer" title="Permalink to this definition">¶</a></dt>
<dd><p>This function returns <tt class="xref docutils literal"><span class="pre">True</span></tt> if <tt class="docutils literal"><span class="pre">file1</span></tt> is newer than <tt class="docutils literal"><span class="pre">file2</span></tt>.  It
handles the case of file arguments that don&#8217;t yet exist.</p>
</dd></dl>

<dl class="function">
<dt id="dep">
<tt class="descname">dep</tt><big>(</big><em>targets</em>, <em>sources</em><span class="optional">[</span>, <em>mapping</em><span class="optional">]</span><big>)</big> &rarr; function<a class="headerlink" href="#dep" title="Permalink to this definition">¶</a></dt>
<dd><p><tt class="docutils literal"><span class="pre">dep</span></tt> is designed to be used as a decorator on tasks for checking whether a
target needs rebuilding.  If the target is up to date the task is not run.</p>
<p>If the <tt class="docutils literal"><span class="pre">mappings</span></tt> argument is <tt class="xref docutils literal"><span class="pre">True</span></tt> then rebuilds are only performed if
a source is newer than a target when the the arguments are paired.  If
<tt class="xref docutils literal"><span class="pre">False</span></tt> a rebuild is performed if <em>any</em> source is a newer than a target.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>targets</strong> (<em>list</em>) &#8211; Targets to check against</li>
<li><strong>sources</strong> (<em>list</em>) &#8211; Sources to check against</li>
<li><strong>mapping</strong> (<em>bool</em>) &#8211; Whether targets map directly to sources</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#"><tt class="docutils literal"><span class="pre">Cake</span></tt> usage</a><ul>
<li><a class="reference internal" href="#cupage-support"><tt class="docutils literal"><span class="pre">cupage</span></tt> support</a><ul>
<li><a class="reference internal" href="#gen-cupage-conf"><tt class="docutils literal"><span class="pre">gen_cupage_conf</span></tt></a></li>
<li><a class="reference internal" href="#cupage-check"><tt class="docutils literal"><span class="pre">cupage_check</span></tt></a></li>
</ul>
</li>
<li><a class="reference internal" href="#layman-support"><tt class="docutils literal"><span class="pre">layman</span></tt> support</a><ul>
<li><a class="reference internal" href="#layman-check"><tt class="docutils literal"><span class="pre">layman_check</span></tt></a></li>
</ul>
</li>
<li><a class="reference internal" href="#maintenance-support-tasks">Maintenance support tasks</a><ul>
<li><a class="reference internal" href="#gen-stable"><tt class="docutils literal"><span class="pre">gen_stable</span></tt></a></li>
<li><a class="reference internal" href="#keyword-check"><tt class="docutils literal"><span class="pre">keyword_check</span></tt></a></li>
<li><a class="reference internal" href="#open-bug"><tt class="docutils literal"><span class="pre">open_bug</span></tt></a></li>
<li><a class="reference internal" href="#bump-pkg"><tt class="docutils literal"><span class="pre">bump_pkg</span></tt></a></li>
</ul>
</li>
<li><a class="reference internal" href="#org-mode-support"><tt class="docutils literal"><span class="pre">org-mode</span></tt> support</a><ul>
<li><a class="reference internal" href="#gen-removals"><tt class="docutils literal"><span class="pre">gen_removals</span></tt></a></li>
</ul>
</li>
<li><a class="reference internal" href="#portage-support"><tt class="docutils literal"><span class="pre">portage</span></tt> support</a><ul>
<li><a class="reference internal" href="#gen-categories"><tt class="docutils literal"><span class="pre">gen_categories</span></tt></a></li>
<li><a class="reference internal" href="#gen-manifests"><tt class="docutils literal"><span class="pre">gen_manifests</span></tt></a></li>
<li><a class="reference internal" href="#gen-news-sigs"><tt class="docutils literal"><span class="pre">gen_news_sigs</span></tt></a></li>
<li><a class="reference internal" href="#gen-use-local-desc"><tt class="docutils literal"><span class="pre">gen_use_local_desc</span></tt></a></li>
</ul>
</li>
<li><a class="reference internal" href="#restructuredtext-support">reStructuredText support</a><ul>
<li><a class="reference internal" href="#gen-html"><tt class="docutils literal"><span class="pre">gen_html</span></tt></a></li>
<li><a class="reference internal" href="#gen-sphinx-html"><tt class="docutils literal"><span class="pre">gen_sphinx_html</span></tt></a></li>
<li><a class="reference internal" href="#gen-thanks"><tt class="docutils literal"><span class="pre">gen_thanks</span></tt></a></li>
<li><a class="reference internal" href="#rst-check"><tt class="docutils literal"><span class="pre">rst_check</span></tt></a></li>
</ul>
</li>
<li><a class="reference internal" href="#tasks-utils"><tt class="docutils literal"><span class="pre">tasks.utils</span></tt></a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="contributing.html"
                        title="previous chapter">Contributing</a></p>
  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="_sources/cake.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" size="18" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="relbar-bottom">
        
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="contributing.html" title="Contributing"
             >previous</a> |</li>
    <li><a href="index.html">jnrowe-misc Documentation</a> &raquo; </li>
 
      </ul>
    </div>
    </div>

    <div class="footer">
        &copy; Copyright 2011, James Rowe.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.0.7.
    </div>
  </body>
</html>